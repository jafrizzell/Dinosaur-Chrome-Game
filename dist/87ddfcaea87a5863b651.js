import Chat from"twitch-chat-emotes";let channels=["moonmoon"];const query_vars={},query_parts=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,i,e){query_vars[i]=e}));query_vars.channels&&(channels=query_vars.channels.split(","));const ChatInstance=new Chat({channels,duplicateEmoteLimit:5}),emoteArray=[];ChatInstance.on("emotes",(t=>{emoteArray.length>20&&emoteArray.pop(0),emoteArray.push({emotes:t,x:Math.floor(Math.random()*canvas.width),y:Math.floor(Math.random()*canvas.height),spawn:Date.now()})}))((function(t){var i="#444",e=!1;function s(t){function i(){this.canvas=t.el,this.canvas.width=.9*window.innerWidth,this.canvas.height=.9*window.innerHeight}this.canvas=t.el,this.context=this.canvas.getContext("2d"),i(),window.addEventListener("resize",i),this.cacti=[],this.nextCactus=0,this.offset=0,this.lastTick=null,this.running=!1,this.finished=!1,this.initObjects(),this.draw(),requestAnimationFrame(this.step.bind(this))}document.addEventListener("keydown",(function(t){32===t.keyCode&&(e=!0)}),!1),document.addEventListener("keyup",(function(t){32===t.keyCode&&(e=!1)}),!1),s.prototype.initObjects=function(){this.player=new Dinosaur({context:this.context,left:10,bottom:this.canvas.height-0,colour:i}),this.background=new Background({context:this.context,width:this.canvas.width,height:this.canvas.height,colour:i}),this.score=new ScoreBoard({context:this.context,left:this.canvas.width-10,bottom:26,colour:i})},s.prototype.updateCacti=function(){for(;this.offset>this.nextCactus;){for(var t=Math.floor(rand(1,3.9)),e=rand(.8,1.5),s=this.canvas.width+this.offset+50;t--;)emoteArray.length>t&&this.cacti.push(new Cactus({left:s+20*t*e,bottom:this.canvas.height-0,scale:e,gif:emoteArray.emotes.slice(-t),leftSize:rand(.5,1.5),rightSize:rand(.5,1.5),centerSize:rand(.5,1.5),colour:i}));this.nextCactus=this.offset+rand(400,this.canvas.width)}},s.prototype.removeOldCacti=function(){for(var t=0;this.cacti.length>t&&this.cacti[t].x<this.offset-50;)t++;this.cacti.splice(0,t)},s.prototype.draw=function(){this.clear(),this.background.draw(this.context,this.offset);for(var t=0;t<this.cacti.length;t++)this.cacti[t].drawColliders(this.context,this.offset),this.cacti[t].draw(this.context,this.offset);this.player.drawColliders(this.context,this.offset),this.player.draw(this.context,this.offset),this.score.draw(this.context,this.offset)},s.prototype.checkCactusHit=function(){for(var t=0;t<this.cacti.length;t++)if(this.player.collidesWith(this.cacti[t],this.offset))return this.running=!1,this.finished=!0,void(this.player.wideEyed=!0)},s.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},s.prototype.step=function(t){this.running&&this.lastTick?(this.offset+=.4*Math.min(t-this.lastTick,16.666666666666668),this.removeOldCacti(),this.updateCacti(),!this.player.isJumping(this.offset)&&e&&this.player.startJump(this.offset),this.checkCactusHit(),this.draw()):e&&(this.running=!0),this.finished||(this.lastTick=t,requestAnimationFrame(this.step.bind(this)))},t.Game=s}))(window);